# 股票投资学习笔记 06：技术分析基础理论与指标

## 技术分析的认识论基础

### 技术分析的定义与假设

技术分析（Technical Analysis）基于三个核心假设：

1. **市场行为涵盖一切信息**：价格反映所有已知和未知的信息，包括基本面、政策、预期等。
2. **价格沿趋势运动**：一旦趋势形成，倾向于持续直到反转信号出现。
3. **历史会重演**：人类行为模式重复，因此价格形态具有预测价值。

**数学表达**：设 $P_t$ 为 t 时刻的价格，则技术分析假设：
$$ P_{t+1} = f(P_t, P_{t-1}, ..., P_{t-k}) + \epsilon_{t+1} $$
其中 $\epsilon$ 为随机误差项。技术分析试图通过历史价格模式预测 $P_{t+1}$。

### 技术分析 vs 基本面分析

两种方法互补而非互斥：

| 维度 | 基本面分析 | 技术分析 |
|------|------------|----------|
| **研究对象** | 内在价值（Intrinsic Value） | 价格行为（Price Action） |
| **时间框架** | 长期（月、季、年） | 短期（日、时、分钟） |
| **决策逻辑** | 价值 vs 价格 | 趋势与信号 |
| **数据来源** | 财务报表、行业研究 | 价格序列、成交量 |
| **核心任务** | 选股、估值 | 择时、仓位管理 |

### 有效市场假说与技术分析

根据 Fama 的有效市场假说（EMH），在弱式有效市场中，历史价格已完全反映，技术分析无法获得超额收益：

$$ E[R_{t+1} \mid P_t, P_{t-1}, ...] = E[R_{t+1}] $$

**实证研究**：
- 大量研究表明，技术分析在扣除交易成本后，难以持续战胜市场。
- 某些形态（如头肩顶/底、双顶/双底）的统计显著性存在争议。
- 高频交易领域，技术分析结合算法交易可能产生微小但持续的 Alpha。

**价值投资者的视角**：
- 技术分析作为基本面投资的补充工具，而非选股依据。
- 主要用于优化买卖时机（Market Timing）。
- 避免过度依赖单一路径。

## 价格行为的数学描述

### 收益率分布

设 $R_t = \frac{P_t - P_{t-1}}{P_{t-1}}$ 为第 t 期收益率。

在有效市场中，$R_t$ 遵循随机游走（Random Walk）：
$$ R_t = \mu + \sigma \epsilon_t $$
其中 $\mu$ 为漂移项（长期期望收益率），$\sigma$ 为波动率，$\epsilon_t \sim N(0,1)$ 为标准正态白噪声。

**技术分析的挑战**：如果价格严格遵循随机游走，则不存在可预测的模式。技术分析试图识别偏离随机游走的异常或趋势。

### 趋势的数学定义

**趋势**：价格序列的持续方向性运动。

**量化方法**：
1. **移动平均线（Moving Average, MA）**：
   $$ MA_n(t) = \frac{1}{n} \sum_{i=0}^{n-1} P_{t-i} $$
   短期 MA > 长期 MA 视为上升趋势，反之视为下降趋势。

2. **线性回归**：
   对时间序列 $P_t$ 进行线性回归：$P_t = \alpha + \beta t + \varepsilon_t$。
   若 $\beta > 0$ 且统计显著，则存在上升趋势。

3. **Mann-Kendall 趋势检验**：
   检验序列是否存在单调趋势。

### 支撑与阻力（Support & Resistance）

**支撑位**：历史上价格多次跌至某价位后反弹的水平。

**阻力位**：历史上价格多次涨至某价位后回落。

**数学视角**：
- 支撑位可视作局部最低值的统计聚类。
- 阻力位可视作局部最高值的统计聚类。

**动态性**：
- 支撑被跌破后，可能成为新的阻力位。
- 阻力被突破后，可能成为新的支撑位。

**心理解释**：
- 支撑/阻力源于市场记忆、成本基础、心理整数关口。

## 技术指标体系

### 趋势指标

#### 1. 移动平均线（Moving Averages）

**SMA（Simple Moving Average）**：
$$ SMA_n(t) = \frac{1}{n} \sum_{i=0}^{n-1} P_{t-i} $$

**EMA（Exponential Moving Average）**：
$$ EMA_n(t) = \alpha P_t + (1-\alpha) EMA_n(t-1) $$
$$ \alpha = \frac{2}{n+1} $$

**特点**：
- EMA 对最新价格更敏感（更快响应趋势变化）。
- 金叉（短期 MA 上穿长期 MA）视为买入信号，死叉（短期 MA 下穿长期 MA）视为卖出信号。

#### 2. MACD（Moving Average Convergence Divergence）

**计算**：
- 快线：$EMA_{12}$
- 慢线：$EMA_{26}$
- MACD 线：$MACD = EMA_{12} - EMA_{26}$
- 信号线：$Signal = EMA_9(MACD)$
- 柱状图：$Histogram = MACD - Signal$

**信号**：
- MACD 上穿 Signal：买入
- MACD 下穿 Signal：卖出
- 背离（Divergence）：价格新高但 MACD 未新高，可能预示趋势疲弱

### 动量指标

#### 1. RSI（Relative Strength Index）

**公式**：
$$ RSI_n(t) = 100 - \frac{100}{1 + RS} $$
$$ RS = \frac{\text{Average of positive } \Delta P \text{ over } n \text{ periods}}{\text{Average of negative } \Delta P \text{ over } n \text{ periods}} $$

**区间**：0-100。

**标准解读**：
- $RSI > 70$：超买（Overbought），可能回调
- $RSI < 30$：超卖（Oversold），可能反弹
- $30 < RSI < 70$：中性区域

**局限性**：在强趋势中，RSI 可长期处于超买/超卖区域（钝化），失去参考价值。

#### 2. KDJ

**基于 RSV（Raw Stochastic Value）**：
$$ RSV = \frac{C_t - L_n}{H_n - L_n} \times 100 $$
其中 $C_t$ 为收盘价，$L_n$ 和 $H_n$ 为 n 日内最低和最高价。

**K、D、J 值**：
- $K_t = \frac{2}{3} RSV_t + \frac{1}{3} K_{t-1}$
- $D_t = \frac{2}{3} K_t + \frac{1}{3} D_{t-1}$
- $J_t = 3K_t - 2D_t$

**信号**：
- K > D 且均超卖：买入
- K < D 且均超买：卖出
- J 指标更敏感，用于领先预警。

### 成交量指标

#### 1. OBV（On-Balance Volume）

**逻辑**：
若当日收盘价高于前一日收盘价，则当日成交量为正；否则为负。OBV 为累积值。

**公式**：
$$ OBV_t = OBV_{t-1} + \begin{cases} Volume_t & \text{if } C_t \geq C_{t-1} \\ -Volume_t & \text{if } C_t < C_{t-1} \end{cases} $$

**应用**：
- OBV 趋势与价格趋势同向：量价齐升，趋势确认。
- OBV 趋势与价格趋势背离：价格新高但 OBV 未新高，可能预示趋势不可持续。

### 波动率指标

#### ATR（Average True Range）

**True Range (TR)**：
$$ TR_t = \max(H_t - L_t, |H_t - C_{t-1}|, |L_t - C_{t-1}|) $$
其中 $H_t$、$L_t$、$C_t$ 为最高、最低、收盘价。

**ATR**：
$$ ATR_n(t) = \frac{1}{n} \sum_{i=0}^{n-1} TR_{t-i} $$

**应用**：
- ATR 衡量价格波动幅度。
- 用于设置止损位：$Stop Loss = Entry Price - k \times ATR$（通常 $k=2-3$）。
- 用于动态仓位管理：波动大时降低仓位。

## 技术形态分析

### 经典形态的统计意义

#### 1. 反转形态（Reversal Patterns）

**头肩顶（Head and Shoulders Top）**：
- 形态：中间峰（头）高于两侧峰（肩）。
- 信号：跌破颈线（连接两肩之间最低点的水平线）。
- 目标位：头到颈线的距离向下投射。

**头肩底（Head and Shoulders Bottom）**：
- 形态：中间谷（头）低于两侧谷（肩）。
- 信号：突破颈线。
- 目标位：头到颈线的距离向上投射。

**双顶/双底（Double Top/Bottom）**：
- 两个相近的顶/底，中间有回调。
- 确认：第二次尝试未能突破。

**统计有效性**：实证研究表明，经典形态的预测准确率略高于随机（约 52-58%），但考虑到交易成本，超额收益有限。

#### 2. 持续形态（Continuation Patterns）

**三角形整理（Triangle）**：
- 上升三角形（Ascending）：阻力线水平，支撑线上倾，多头力量增强。
- 下降三角形（Descending）：支撑线水平，阻力线下倾，空头力量增强。
- 对称三角形（Symmetrical）：上下趋势线收敛，方向不确定。

**旗形/楔形（Flags/Wedges）**：
- 旗形：平行通道内的整理，通常沿原趋势方向突破。
- 楔形：收敛通道，可能预示反转或继续。

### 形态的局限

1. **主观性**：形态识别存在主观性，不同分析者可能得出不同结论。
2. **事后确认**：形态完成前无法确认，完成时已错过部分行情。
3. **假突破**：形态突破后可能迅速回归，导致"假信号"。

## 技术分析的局限与实证

### 实证研究结论

1. **超额收益有限**：大量文献表明，考虑交易成本后，纯技术分析策略难以持续战胜市场。
2. **自我实现效应**：当大量交易者使用相同技术指标时，信号可能自我实现，也可能自我失效。
3. **市场环境依赖**：技术分析在趋势市场有效，在震荡或高波动市场失效。

### 常见误区

1. **过度拟合（Overfitting）**：使用过多指标寻找"完美"信号，导致信号过拟合历史数据。
2. **确认偏差（Confirmation Bias）**：倾向于寻找支持自己判断的信号，忽略反面证据。
3. **滞后性陷阱**：所有指标均基于历史数据，本质上是滞后的，过度追求精确信号可能导致追涨杀跌。

### 价值投资者的技术分析原则

1. **辅助而非主导**：基本面决定买什么（选股），技术分析决定何时买（择时）。
2. **简化指标体系**：避免过多指标，选择 2-3 个核心指标。
3. **确认胜于预测**：等待多个指标确认信号，而非单一指标触发即行动。
4. **设置规则而非情绪**：事先设定买卖规则（如金叉 + RSI 中性 + 成交量确认），执行时不受情绪影响。

---

*参考资料：Edwards & Magee (1948), Murphy (1999), Lo, Mamaysky & Wang (2000)*

上一篇：行业分析与战略定位 | 下一篇：交易心理学
